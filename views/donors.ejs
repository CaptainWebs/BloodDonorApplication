<% include partials/header%>
<% var count=0;%>
<% eligibleUsers.forEach(function(user){%>
<%    count++; %>
<% })%>
<% ineligibleUsers.forEach(function(user){%>
<%    count++; %>
<% })%>
<div class="row gradientbg" style="padding-top:100px;color:white;padding-bottom:10px;">
   <div class="col-md-4 col-md-offset-1" style="text-align:left;">
      <h2>Search Results</h2>
      <p>
         <% if(count==0){%>
         No result is found.
         <% }else if(count == 1){ %>
         1 result is found.
         <% }else{ %>
         <%= count%> results are found.
         <% } %>
      </p>
      <button class="btn btn-primary" type="button" id="toggle" onclick="toggle()" style="background:#2e3436;outline:none;border:none;"><i class="far fa-edit"></i> Modify Search</button>
   </div>
   <div class="col-md-4 col-md-offset-1" style="padding-top:10px;border:2px solid #2e3436;border-radius:5px;">
      <h5><i class="fas fa-exclamation"></i> Please note:</h5>
      <h5><span style="text-decoration:underline;">Eligible User <i class="fas fa-check greenicon"></i></span><span style="color:#dfe6e9;">: user's last donation is 12(or 16) weeks beyond today's date and user may be eligible to donate blood.</span></h5>
      <h5><span style="text-decoration:underline;">Ineligible User <i class="fas fa-times redicon"></i></span><span style="color:#dfe6e9;">: user's last donation is not 12(or 16) weeks beyond today's date and user may not eligible to donate blood..</span></h5>
   </div>
</div>
<div class="row hidden" style="padding-top:10px;background:#2e3436;color:white;padding-bottom:10px;display:block" id="data">
   <div class="col-md-10 col-md-offset-1" style="padding-top:10px;background:#2e3436;color:white;margin-bottom:20px;">
      <h4 style="float:left;">Modify Search</h4>
      <button class="btn btn-primary" type="button" id="toggle" onclick="toggle2()" style="float:right;background:#b02528;border:0;outline:none;"><i class="far fa-window-close"></i> Close</button>
      <form class="px-4 py-3" action="/results" method="GET">
         <div class="form-row">
            <div class="form-group col-md-12"
            <label for="exampleDropdownFormEmail1" style="color:white;"> Select the Blood Type</label>
            <select class="selectpicker" name="bloodType" data-style="btn-info" multiple data-max-options="1" data-live-search="true" required>
               <optgroup label="A group">
                  <option>A+ (A Rhd positive)</option>
                  <option>A- (A Rhd negative)</option>
               </optgroup>
               <optgroup label="B group">
                  <option>B+ (B Rhd positive)</option>
                  <option>B- (B Rhd negative)</option>
               </optgroup>
               <optgroup label="AB group">
                  <option>AB+ (AB Rhd positive)</option>
                  <option>AB- (AB Rhd negative)</option>
               </optgroup>
               <optgroup label="O group">
                  <option>O+ (O Rhd positive)</option>
                  <option>O- (O Rhd negative)</option>
               </optgroup>
            </select>
         </div>
   </div>
   <div class="form-row">
   <div class="form-group col-md-6">
   <select name="country" class="countries" style="width:100%;height:40px;color:gray;" id="countryId" required>
   <option value="">Please Select Country</option>
   </select>
   </div>  
   <div class="form-group col-md-6">
   <input type="text" style="width:100%;height:40px;color:gray;" class="form-control" name="city" id="exampleDropdownFormEmail1" placeholder="City" required>
   </div>
   </div>
   <div class="form-row">
   <div class="form-group col-md-6">
   <input type="text" style="width:100%; height:40px;color:gray;" class="form-control" name="postcode" id="exampleDropdownFormEmail1" placeholder="Postcode">   
   </div>
   <div class="form-group col-md-6">
   <button class="btn-full-search" style="background:#b02428;color:white;" value="Search" type="submit"><i class="fa fa-search" aria-hidden="true"></i> Search</button>
   </div>
   </div>
   </form>
</div>
</div>
<% if(eligibleUsers != [] && eligibleUsers.length > 0 && eligibleUsers != null && (typeof eligibleUsers != undefined)){ %>
<% eligibleUsers.forEach(function(user){%>    
<div class="row donorsearch" style="padding:20px;">
   <div class="col-md-10 col-md-offset-1">
      <h4>Eligible User <i class="fas fa-check greenicon"></i></h4>
      <div class="row">
         <!--Profile image-->
         <div class="col-md-2 col-md-offset-1">
            <image src="/images/<%=user.user.gender%>.png" style="height:100px; width:100px; border-radius:20px;display:block;margin:0 auto;">
         </div>
         <div class="col-md-6">
            <div class="row">
               <div class="col-md-5">
                  <p><i class="fa fa-user-circle redicon"></i> <%= user.user.firstName%> <%=user.user.lastName%><br>
                     <i class="fa fa-at redicon"></i> <%= user.user.username%>
                  </p>
               </div>
               <div class="col-md-4">
                  <p><i class="fa fa-map-marker redicon"></i> <%= user.user.country%>, <%= user.user.city%></p>
               </div>
               <div class="col-md-3">
                  <p><i class="fas fa-tint redicon"></i> Blood Type: <br><span style="color:#B02428;font-weight:strong;"><%= user.user.bloodType%></span></p>
               </div>
            </div>
         </div>
         <div class="col-md-2">
            <form action="/profile/<%= user.user.username%>" method="GET"><button type="submit" class="btn btn-default" style="border:0;background:#2E3436;color:white;"><i class="fas fa-eye"></i> View Profile</button></form>
            <a href="mailto:'<%=user.user.email%>'"><button class="btn btn-primary" style="margin-top:10px;background:#0984e3;border:0;"><i class="fas fa-envelope"></i> Send Email</button></a>
         </div>
      </div>
   </div>
</div>
<% }); %>
<% } %>
<% if(ineligibleUsers != [] && ineligibleUsers.length > 0 && ineligibleUsers != null && (typeof ineligibleUsers != undefined)){ %>
<% ineligibleUsers.forEach(function(user){%>    
<div class="row donorsearch" style="padding:20px;">
   <div class="col-md-10 col-md-offset-1">
      <h4>Ineligible User <i class="fas fa-times redicon"></i></h4>
      <div class="row">
         <!--Profile image-->
         <div class="col-md-2 col-md-offset-1">
            <image src="/images/<%=user.user.gender%>.png" style="height:100px; width:100px; border-radius:20px;display:block;margin:0 auto;">
         </div>
         <div class="col-md-6">
            <div class="row">
               <div class="col-md-5">
                  <p><i class="fa fa-user-circle redicon"></i> <%= user.user.firstName%> <%= user.user.lastName%><br>
                     <i class="fa fa-at redicon"></i> <%= user.user.username%>
                  </p>
               </div>
               <div class="col-md-4">
                  <p><i class="fa fa-map-marker redicon"></i> <%= user.user.country%>, <%= user.user.city%></p>
               </div>
               <div class="col-md-3">
                  <p><i class="fas fa-tint redicon"></i> Blood Type: <br><span style="color:#B02428;font-weight:strong;"><%= user.user.bloodType%></span></p>
               </div>
            </div>
         </div>
         <div class="col-md-2">
            <form action="/profile/<%=user.user.username%>" method="GET"><button type="submit" class="btn btn-default" style="border:0;background:#2E3436;color:white;"><i class="fas fa-eye"></i> View Profile</button></form>
<a href="mailto:'<%=user.user.email%>'"><button class="btn btn-primary" style="margin-top:10px;background:#0984e3;border:0;"><i class="fas fa-envelope"></i> Send Email</button></a>         </div>
      </div>
   </div>
</div>
<% }); %>
<% } %>
<script>
   function toggle(){
     document.getElementById('data').removeAttribute('class', 'hidden');
   
   }
   
   function toggle2(){
     document.getElementById('data').setAttribute("class", 'hidden');
   
   }
   
</script>
<% include partials/footer%>